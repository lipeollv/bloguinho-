[
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Cotação do dolar",
    "section": "",
    "text": "Cotação do dolar - como desenvolver uma função em Python que te mostre as informações atuais de uma moeda (dolar).\nBibliotecas necessárias para rodar a função.\n\nimport requests\nimport calendar\nfrom datetime import datetime, timedelta\nimport plotly.express as px\n\nFunção para cotar um único dia. Se não encontrar a cotação do dia, ela chama ela mesma para tentar o dia anterior.\n\ndef cotar(data):\n    url = fr\"https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoDolarDia(dataCotacao=@dataCotacao)?@dataCotacao='{data}'&$format=json\"\n    res = requests.get(url).json()\n\n    if res[\"value\"]:\n        return res[\"value\"][0][\"cotacaoVenda\"]\n    else:  # se nao tem cotação (fim de semana ou feriado), pega o dia anterior\n        dia_anterior = datetime.strptime(data, \"%m%d%Y\") - timedelta(days=1)\n        dia_anterior = datetime.strftime(dia_anterior, \"%m%d%Y\")\n        return cotar(dia_anterior)\n\nFunção para o mês initeiro. Ela recebe ‘MMYYYY’, gera todas as datas do mês e usa a função de cima para um único dia.\n\ndef cotacao_dolar_mes(mmyyyy):\n\n    # interpretar MMYYYY\n    primeiro_dia = datetime.strptime(mmyyyy, \"%m%Y\")\n    ultimo_dia_num = calendar.monthrange(primeiro_dia.year, primeiro_dia.month)[1]\n    ultimo_dia = primeiro_dia.replace(day=ultimo_dia_num)\n\n    # criar lista com todos os dias do mês\n    datas = []\n    dia = primeiro_dia\n    while dia &lt;= ultimo_dia:\n        datas.append(dia)\n        dia += timedelta(days=1)\n\n    # converter para o formato da API \n    datas_api = [d.strftime(\"%m%d%Y\") for d in datas]\n\n    # cotar cada dia (usa recursão para pegar dia anterior)\n    cotacoes = [cotar(data_str) for data_str in datas_api]\n\n    # gerar gráfico\n    fig = px.line(\n        x=datas,\n        y=cotacoes,\n        title=f\"Cotação do Dólar - {mmyyyy[:2]}/{mmyyyy[2:]}\",\n        labels={\"x\": \"Data\", \"y\": \"Cotação de Venda (R$)\"}\n    )\n\n    return fig\n\nExemplo&gt; Março de 2024\n\n# Exemplo: março de 2024\nfig = cotacao_dolar_mes(\"032024\")\nfig.show()\n\n                            \n                                            \n\n\nEsse comando gera um gráfico de linha mostrando a variação da cotação do dólar durante todo o mês."
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Regressão Linear",
    "section": "",
    "text": "Regressão Linear\nComo desenvolver uma função em python para calcular uma regressão linear.\nBibliotecas\n\nimport numpy as np\nfrom plotnine import (\n    ggplot, aes, geom_point, geom_abline, ggsave\n)\nimport pandas as pd\nimport os\n\nprint(\"Caminho atual:\", os.getcwd())\nprint(\"Arquivos encontrados:\", os.listdir())\n\nCaminho atual: /workspaces/bloguinho/posts/welcome\nArquivos encontrados: ['y.txt', 'index.quarto_ipynb', 'index.qmd', 'X.txt', 'thumbnail.jpg', 'grafico.png']\n\n\nLeitura dos dados\n\nX = np.loadtxt(\"X.txt\")   # anos de estudo\ny = np.loadtxt(\"y.txt\")   # salário\n\nConstruir a matriz X com 1s\n\nn = len(X)\nXmat = np.column_stack((np.ones(n), X))\n\nFórmula matricial (X^T X)^(-1) X^T y\n\nbeta = np.linalg.inv(Xmat.T @ Xmat) @ (Xmat.T @ y)\n\na = beta[0]  # intercepto\nb = beta[1]  # inclinação\n\nprint(\"Intercepto (a):\", a)\nprint(\"Inclinação (b):\", b)\n\nIntercepto (a): 373.93446839132355\nInclinação (b): 991.6278332981952\n\n\nCriar o gráfico com plotnine\n\ndf = {\"x\": X, \"y\": y}\n\nplot = (\n    ggplot(pd.DataFrame(df), aes(\"x\", \"y\"))\n    + geom_point()\n    + geom_abline(intercept=a, slope=b)\n)\n\nplot.save(\"grafico.png\")\n\nfrom IPython.display import Image\nImage(filename=\"grafico.png\")\n\n/home/codespace/.python/current/lib/python3.12/site-packages/plotnine/ggplot.py:623: PlotnineWarning: Saving 7.0 x 5.0 in image.\n/home/codespace/.python/current/lib/python3.12/site-packages/plotnine/ggplot.py:624: PlotnineWarning: Filename: grafico.png"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "bloguinho",
    "section": "",
    "text": "Cotação do dolar\n\n\n\nAPI\n\ncode\n\ndolar\n\n\n\n\n\n\n\n\n\nNov 23, 2025\n\n\nFilipe Cavalcanti\n\n\n\n\n\n\n\n\n\n\n\n\nFrota de Ônibus\n\n\n\nnews\n\npython\n\ntrasport\n\n\n\n\n\n\n\n\n\nNov 20, 2025\n\n\nFilipe Cavalcanti\n\n\n\n\n\n\n\n\n\n\n\n\nRegressão Linear\n\n\n\nmath\n\npython\n\n\n\n\n\n\n\n\n\nNov 20, 2025\n\n\nFilipe Cavalcanti\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/cotação_dolar/index.html",
    "href": "posts/cotação_dolar/index.html",
    "title": "Cotação do dolar",
    "section": "",
    "text": "Cotação do dolar - como desenvolver uma função em Python que te mostre as informações atuais de uma moeda (dolar).\nBibliotecas necessárias para rodar a função.\n\nimport requests\nimport calendar\nfrom datetime import datetime, timedelta\nimport plotly.express as px\n\nFunção para cotar um único dia. Se não encontrar a cotação do dia, ela chama ela mesma para tentar o dia anterior.\n\ndef cotar(data):\n    url = fr\"https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoDolarDia(dataCotacao=@dataCotacao)?@dataCotacao='{data}'&$format=json\"\n    res = requests.get(url).json()\n\n    if res[\"value\"]:\n        return res[\"value\"][0][\"cotacaoVenda\"]\n    else:  # se nao tem cotação (fim de semana ou feriado), pega o dia anterior\n        dia_anterior = datetime.strptime(data, \"%m%d%Y\") - timedelta(days=1)\n        dia_anterior = datetime.strftime(dia_anterior, \"%m%d%Y\")\n        return cotar(dia_anterior)\n\nFunção para o mês initeiro. Ela recebe ‘MMYYYY’, gera todas as datas do mês e usa a função de cima para um único dia.\n\ndef cotacao_dolar_mes(mmyyyy):\n\n    # interpretar MMYYYY\n    primeiro_dia = datetime.strptime(mmyyyy, \"%m%Y\")\n    ultimo_dia_num = calendar.monthrange(primeiro_dia.year, primeiro_dia.month)[1]\n    ultimo_dia = primeiro_dia.replace(day=ultimo_dia_num)\n\n    # criar lista com todos os dias do mês\n    datas = []\n    dia = primeiro_dia\n    while dia &lt;= ultimo_dia:\n        datas.append(dia)\n        dia += timedelta(days=1)\n\n    # converter para o formato da API \n    datas_api = [d.strftime(\"%m%d%Y\") for d in datas]\n\n    # cotar cada dia (usa recursão para pegar dia anterior)\n    cotacoes = [cotar(data_str) for data_str in datas_api]\n\n    # gerar gráfico\n    fig = px.line(\n        x=datas,\n        y=cotacoes,\n        title=f\"Cotação do Dólar - {mmyyyy[:2]}/{mmyyyy[2:]}\",\n        labels={\"x\": \"Data\", \"y\": \"Cotação de Venda (R$)\"}\n    )\n\n    return fig\n\nExemplo&gt; Março de 2024 Esse comando gera um gráfico de linha mostrando a variação da cotação do dólar durante todo o mês.\n\n# Exemplo: março de 2024\nfig = cotacao_dolar_mes(\"032024\")\nfig.show()"
  },
  {
    "objectID": "posts/frota_de_onibus/index.html",
    "href": "posts/frota_de_onibus/index.html",
    "title": "Frota de Ônibus",
    "section": "",
    "text": "Monitoramento de frota de ônibus\nPrimeira precisamos criar um arquivo .env para conseguir colocar o TOKEN da API OLHO VIVO do sptrans.\nLogin na API\n\nimport os\nimport requests\nfrom dotenv import load_dotenv\nimport folium\n\n# carregar token do arquivo .env\nload_dotenv(\".env\")\n\ns = requests.Session()\n\n# autenticar no sistema\nres = s.post(\n    f\"http://api.olhovivo.sptrans.com.br/v2.1/Login/Autenticar?token={os.getenv('SPTRANS_TOKEN')}\"\n)\n\nprint(\"Autenticação:\", res.text)\n\nAutenticação: true\n\n\nVocê escolhe sua linha\n\nlinha = \"875A\"  # troque para a linha que você quer\n\nBusca os dados da linha\n\n# buscar a linha e pegar o código interno\nlinha = \"875A\"\n\nres_linha = s.get(\n    f\"http://api.olhovivo.sptrans.com.br/v2.1/Linha/Buscar?termosBusca={linha}\"\n).json()\n\nif not res_linha:\n    raise Exception(\"Linha não encontrada.\")\n\n# pegar somente o sentido IDA\nlinha_ida = next(item for item in res_linha if item[\"sl\"] == 1)\n\ncodigo_linha = linha_ida[\"cl\"]\nprint(\"Código interno:\", codigo_linha)\n\nCódigo interno: 609\n\n\nAgora busca as paradas dessa linha\n\n# pegar as paradas dessa linha\nparadas = s.get(\n    f\"http://api.olhovivo.sptrans.com.br/v2.1/Parada/BuscarParadasPorLinha?codigoLinha={codigo_linha}\"\n).json()\n\nprint(\"Total de paradas:\", len(paradas))\n\nTotal de paradas: 7\n\n\nConstrução do mapa\n\n# coordenadas iniciais para centralizar o mapa\nlat0 = paradas[0][\"py\"]\nlon0 = paradas[0][\"px\"]\n\n\n# criar mapa\nmapa = folium.Map(location=[lat0, lon0], zoom_start=13)\n\nColocar os pins de parada (cor azul)\n\nfor p in paradas:\n    folium.Marker(\n        [p[\"py\"], p[\"px\"]],\n        popup=p[\"np\"],\n        icon=folium.Icon(color=\"blue\", icon=\"info-sign\")\n    ).add_to(mapa)\n\nBuscar a posição do ônibus em tempo real\n\n# posição em tempo real dos ônibus da linha\nposicoes = s.get(\n    f\"http://api.olhovivo.sptrans.com.br/v2.1/Posicao/Linha?codigoLinha={codigo_linha}\"\n).json()\n\nonibus = posicoes[\"vs\"]\nprint(\"Veículos encontrados:\", len(onibus))\n\nVeículos encontrados: 5\n\n\nColocar os pins dos ônibus (vermelho)\n\nfor v in onibus:\n    folium.Marker(\n        [v[\"py\"], v[\"px\"]],\n        popup=f\"Veículo {v['p']}\",\n        icon=folium.Icon(color=\"red\", icon=\"bus\")\n    ).add_to(mapa)\n\nE por fim, mostrar o mapa\n\nmapa\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook"
  }
]